<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PTSEL Clipper (Phase 1)</title>
  <style>
    body { background:#0f172a; color:#e5e7eb; font-family:system-ui, Arial; margin:0; display:flex; align-items:center; justify-content:center; min-height:100vh; }
    .card { background:#111827; width:420px; padding:24px; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.35) }
    h1 { margin:0 0 8px; font-size:22px; }
    p { margin:6px 0 14px; color:#9ca3af }
    label { display:block; margin:10px 0 6px; font-size:14px; color:#cbd5e1 }
    input[type="text"], input[type="file"] { width:100%; padding:10px 12px; border-radius:8px; border:1px solid #374151; background:#0b1220; color:#e5e7eb; }
    .row { display:flex; gap:10px; }
    .row > div { flex:1; }
    button { width:100%; padding:12px; border:0; border-radius:10px; background:#3b82f6; color:white; font-weight:600; cursor:pointer; }
    button:hover { background:#2563eb; }
    .note { font-size:12px; color:#94a3b8; margin-top:8px }
    .status { margin-top:12px; font-size:14px; }
    .link { margin-top:14px; display:block; color:#22d3ee; text-decoration:none; word-break:break-all;}
    .or { text-align:center; color:#94a3b8; margin:10px 0; }
  </style>
</head>
<body>
  <div class="card">
    <h1>üé¨ PTSEL Clipper</h1>
    <p>Upload a video <em>or</em> paste a YouTube link. Set Start & End. Max clip = 60 minutes.</p>

    <label for="file">Upload Video (mp4/mov/webm‚Ä¶)</label>
    <input id="file" type="file" accept="video/*" />

    <div class="or">‚Äî or ‚Äî</div>

    <label for="url">YouTube URL</label>
    <input id="url" type="text" placeholder="https://www.youtube.com/watch?v=..." />

    <div class="row">
      <div>
        <label for="start">Start</label>
        <input id="start" type="text" placeholder="SS | MM:SS | HH:MM:SS">
      </div>
      <div>
        <label for="end">End</label>
        <input id="end" type="text" placeholder="SS | MM:SS | HH:MM:SS">
      </div>
    </div>

    <button id="go">Trim</button>
    <div class="note">Tip: For accuracy, we re-encode to H.264/AAC. Download link appears below.</div>

    <div id="status" class="status"></div>
    <a id="dl" class="link" href="#" style="display:none" download>‚¨áÔ∏è Download clip</a>
  </div>

  <script>
    const statusEl = document.getElementById("status");
    const linkEl = document.getElementById("dl");

    function setStatus(msg, ok=false) {
      statusEl.textContent = msg;
      statusEl.style.color = ok ? "#4ade80" : "#e5e7eb";
    }
    function setError(msg) {
      statusEl.textContent = "‚ùå " + msg;
      statusEl.style.color = "#f87171";
    }

    document.getElementById("go").addEventListener("click", async () => {
      statusEl.textContent = "";
      linkEl.style.display = "none";
      linkEl.removeAttribute("href");

      const file = document.getElementById("file").files[0] || null;
      const url = document.getElementById("url").value.trim() || "";
      const start = document.getElementById("start").value.trim();
      const end = document.getElementById("end").value.trim();

      if (!file && !url) return setError("Upload a file or paste a YouTube URL.");
      if (!start || !end) return setError("Start and End are required (SS | MM:SS | HH:MM:SS).");

      setStatus("‚è≥ Uploading / preparing‚Ä¶");

      try {
        const form = new FormData();
        if (file) form.append("file", file);
        if (url && !file) form.append("url", url);
        form.append("start", start);
        form.append("end", end);

        const res = await fetch("/trim", {
          method: "POST",
          body: form
        });

        const data = await res.json();
        if (!res.ok || !data.ok) {
          return setError(data.detail || data.error || "Trim failed.");
        }

        setStatus("‚úÖ Clip ready!", true);
        linkEl.href = data.download_url;
        linkEl.style.display = "block";
        linkEl.textContent = `‚¨áÔ∏è Download clip (${Math.round((data.size_bytes || 0)/1024/1024)} MB)`;
      } catch (err) {
        setError(err.message || "Network error.");
      }
    });
  </script>
</body>
</html>
